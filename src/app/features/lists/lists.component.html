<div class="library-container">
  <div class="library-header">
    <h1>Library</h1>
  </div>

  <nav class="library-nav">
    <div class="nav-tabs">
      <a
        routerLinkActive="active"
        class="nav-tab"
        (click)="navigateToTab('current-reads')"
      >
        Current reads
      </a>
      <a
        routerLinkActive="active"
        class="nav-tab"
        (click)="navigateToTab('archive')"
      >
        Archive
      </a>
      <a
        routerLinkActive="active"
        class="nav-tab"
        (click)="navigateToTab('reading-lists')"
      >
        Reading lists
      </a>
    </div>
  </nav>

  <div class="library-content">
    <!-- Reading Lists Tab Content -->
    <div *ngIf="currentTab === 'reading-lists'" class="reading-lists-content">
      <button class="create-btn" (click)="openModal()">
        <span class="plus-icon">+</span>
        Create reading list
      </button>

      <div class="reading-lists">
        <div
          cdkDropList
          [cdkDropListData]="readingLists"
          class="list custom-drop-list"
          (cdkDropListDropped)="drop($event)"
        >
          <div
            *ngFor="let list of readingLists; let i = index"
            class="reading-list-item custom-drag-item"
            cdkDrag
            [cdkDragData]="list"
            [cdkDragDisabled]="false"
          >
            <div *ngIf="list.items" class="list-stories-images">
              <div class="main-image">
                <img
                  *ngFor="let item of list.items.slice(0, 1)"
                  [src]="item.coverImageUrl || 'assets/img/profile.jpg'"
                  alt="Story image"
                  class="main-preview-image"
                />
              </div>
              <div class="secondary-images">
                <img
                  *ngFor="let item of list.items.slice(1, 3)"
                  [src]="item.coverImageUrl || 'assets/img/profile.jpg'"
                  alt="Story image"
                  class="secondary-image"
                />
              </div>
            </div>

            <div class="list-info">
              <h3 class="list-title">{{ list.name }}</h3>
              <p class="list-stats">
                {{ list.storyCount }}
                {{ list.storyCount === 1 ? "story" : "stories" }}
                <span *ngIf="list.storyCount === 0">lists</span>
              </p>
            </div>

            <div
              class="list-actions"
              *ngIf="list.readingListType !== ReadingListTypeEnum.Liked"
            >
              <button class="menu-btn" (click)="toggleMenu(i)">
                <span class="menu-dots">⋮</span>
              </button>

              <div class="dropdown-menu" *ngIf="openedMenuIndex === i">
                <button class="dropdown-item" (click)="editList(list)">
                  <span class="icon">✏️</span> Edit
                </button>
                <button
                  class="dropdown-item delete"
                  (click)="deleteById(list.id)"
                >
                  <span class="icon">🗑️</span> Delete
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Current Reads Tab Content -->
    <div *ngIf="currentTab === 'current-reads'" class="tab-content">
      <div class="privacy-indicator">
        <span class="lock-icon">🔒</span>
        Private
      </div>
      <p class="no-content">No stories available.</p>
    </div>

    <!-- Archive Tab Content -->
    <div *ngIf="currentTab === 'archive'" class="tab-content">
      <div class="privacy-indicator">
        <span class="lock-icon">🔒</span>
        Private
      </div>
      <p class="no-content">No stories available.</p>
    </div>
  </div>
</div>
<app-reading-list-modal
  [(visible)]="showModal"
  (create)="createReadingList($event)"
>
</app-reading-list-modal>
